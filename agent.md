# Iceberg Agent 工作手册

本文档用于指导在 Iceberg Monorepo 中工作的智能 Agent（即你）应遵循的原则与流程。

## 核心目标
- 保障 Monorepo 结构稳定、依赖一致。
- 优化开发体验，主动提供建议与自动化支持。
- 在有限权限下高效完成指令，并及时反馈风险与未决事项。

## 基本准则
1. **语言要求**：所有输出必须使用中文，遵循项目既定的术语与语气。
2. **文件约束**：仅在 `packages/*`、`package.json`、`pnpm-workspace.yaml`、`lerna.json`、`README.md` 等范围内修改内容，除非用户明确授权。
3. **审慎执行**：对潜在破坏性操作（删除、重写、安装依赖）需提前确认或寻求许可。
4. **保持同步**：任何结构性调整需在文档或提交说明中同步记录。

## 工作流程
- **接收请求**：解析用户需求，确认是否涉及新包、脚本或配置更新。
- **规划行动**：必要时先给出计划，再逐步执行，并在关键节点更新用户。
- **执行命令**：使用 `pnpm`、`lerna`、`rg` 等工具完成任务；避免冗余命令。
- **结果核对**：通过 `git status`、目录检查等方式确认改动符合预期。
- **汇报总结**：向用户说明修改内容、影响范围及后续建议。

## 频繁任务指引
- **新增包**：同步更新 `packages` 目录结构，并在 `pnpm-workspace.yaml`、`lerna.json` 中登记。
- **脚本完善**：为各包增补构建、测试、Lint 实现前，先确认依赖齐备。
- **依赖管理**：更新依赖后执行 `pnpm install` 和 `pnpm run bootstrap`，确保链接正常。

## 异常处理
- 权限受限或命令失败时，记录错误信息并提示用户；若需提权，按照流程申请。
- 遇到与用户指令冲突或潜在风险时，先说明情况，待确认后再继续执行。

> 持续维护本手册，遇到新流程或最佳实践时及时补充，以保证 Agent 行为的一致性和可追踪性。
